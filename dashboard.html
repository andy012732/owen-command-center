<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>德谷拉學長戰略指揮部 V6.3 - 數據分析強化版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #0ea5e9;
            --neon-purple: #a855f7;
            --neon-green: #22c55e;
            --neon-red: #ef4444;
            --neon-yellow: #eab308;
            --bg-dark: #020617;
        }
        body { background-color: var(--bg-dark); color: #f8fafc; font-family: 'Noto Sans TC', sans-serif; overflow-x: hidden; margin: 0; }
        .cyber-font { font-family: 'Orbitron', sans-serif; }
        .glow-card { background: rgba(15, 23, 42, 0.8); border: 1px solid #1e293b; backdrop-filter: blur(8px); position: relative; transition: all 0.3s; }
        .glow-card:hover { border-color: var(--neon-blue); box-shadow: 0 0 15px rgba(14, 165, 233, 0.2); }
        .neon-text-blue { color: var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue); }
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .scan-line { width: 100%; height: 1px; background: linear-gradient(to right, transparent, var(--neon-blue), transparent); position: absolute; top: 0; left: 0; animation: scan 4s linear infinite; pointer-events: none; z-index: 10; opacity: 0.3; }
        @keyframes scan { from { transform: translateY(0); } to { transform: translateY(400px); } }
        .ammo-bar { height: 8px; background: #0f172a; border: 1px solid #1e293b; overflow: hidden; border-radius: 2px; }
        .ammo-fill { height: 100%; transition: width 1s ease-in-out; }

        
        .progress-circle { position: relative; width: 60px; height: 60px; border-radius: 50%; background: conic-gradient(var(--neon-blue) var(--p), #1e293b 0); display: flex; align-items: center; justify-content: center; }
        .progress-circle::after { content: ""; position: absolute; width: 50px; height: 50px; background: var(--bg-dark); border-radius: 50%; }
        .progress-inner { position: relative; z-index: 10; font-size: 10px; font-weight: bold; color: var(--neon-blue); }
    </style>
    <script>
        const PIN_HASH = "MDMyNg==";
        const els = {
            input: document.getElementById('pin-input'),
            overlay: document.getElementById('auth-overlay'),
            content: document.getElementById('hq-content'),
            error: document.getElementById('auth-error'),
            clock: document.getElementById('live-clock'),
            countdown: document.getElementById('countdown')
        };

        els.input.addEventListener('input', (e) => {
            if (e.target.value.length === 4) {
                if (btoa(e.target.value) === PIN_HASH) unlock();
                else { els.error.style.opacity = '1'; e.target.value = ''; setTimeout(()=>els.error.style.opacity='0', 1500); }
            }
        });

        function unlock() {
            els.overlay.style.display = 'none';
            els.content.classList.remove('hidden');
            sessionStorage.setItem('dracula_v5_auth', 'true');
            initRadar();
        }

        if (sessionStorage.getItem('dracula_v5_auth') === 'true') unlock();

        function initRadar() {
            const ctx = document.getElementById('radarChart');
            if(!ctx) return;
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['成交', '客單', '出勤', '日誌', '社群', '產品'],
                    datasets: [{ label: '阿德', data: [65,50,90,40,60,85], borderColor: '#0ea5e9', backgroundColor: 'rgba(14,165,233,0.2)', pointRadius: 0 },
                               { label: '家志', data: [85,80,75,85,95,70], borderColor: '#a855f7', backgroundColor: 'rgba(168,85,247,0.2)', pointRadius: 0 }]
                },
                options: {
                    scales: { r: { grid: { color: '#1e293b' }, angleLines: { color: '#1e293b' }, ticks: { display: false }, pointLabels: { font: { size: 7 }, color: '#475569' } } }, plugins: { legend: { display: false } } }
            });
        }

        function showDetail(id) {
            document.getElementById('main-view').classList.add('hidden');
            document.getElementById('sub-view').classList.remove('hidden');
            const dataMap = {
                zhubei: { name: "竹北旗艦部", total: "$10.04M", ratio: "60:40", growth: "+18.2%", color: "#0ea5e9", history: [60, 80, 50, 90, 75, 85] },
                xinfeng: { name: "新豐分部", total: "$5.57M", ratio: "45:55", growth: "+8.5%", color: "#eab308", history: [40, 50, 30, 45, 55, 48] },
                online: { name: "線上官網 (91APP)", total: "數據串接中", ratio: "100:0", growth: "N/A", color: "#a855f7", history: [0, 0, 0, 0, 0, 0] }
            };
            const d = dataMap[id];
            document.getElementById('sub-view-title').innerText = d.name;
            document.getElementById('sub-view-title').style.color = d.color;
            document.getElementById('sub-view-container').style.borderColor = d.color;
            document.getElementById('sub-view-body').innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
                    <div class="bg-slate-900 p-5 rounded border border-slate-800"><p class="text-[8px] text-gray-500 uppercase mb-1">歷年總累積營收</p><p class="text-2xl font-black cyber-font text-white">${d.total}</p></div>
                    <div class="bg-slate-900 p-5 rounded border border-slate-800"><p class="text-[8px] text-gray-500 uppercase mb-1">支付結構 (數位:現金)</p><p class="text-2xl font-black cyber-font text-white">${d.ratio}</p></div>
                    <div class="bg-slate-900 p-5 rounded border border-slate-800"><p class="text-[8px] text-gray-500 uppercase mb-1">週期成長率</p><p class="text-2xl font-black cyber-font text-green-400">${d.growth}</p></div>
                </div>
                <div class="border-t border-slate-800 pt-8">
                    <h4 class="text-[10px] font-bold text-sky-500 mb-8 cyber-font uppercase tracking-[0.3em]">店鋪歷史表現趨勢 (Combat History)</h4>
                    <div class="h-48 flex items-end justify-between gap-3 px-4 border-b border-slate-800 pb-2">
                        ${d.history.map(h => `<div class="bg-slate-800 w-full rounded-t relative"><div class="absolute bottom-0 w-full rounded-t opacity-80" style="height: ${h}%; background-color: ${d.color}; box-shadow: 0 0 15px ${d.color}44;"></div></div>`).join('')}
                    </div>
                    <div class="flex justify-between text-[7px] text-gray-600 mt-2 cyber-font">
                        <span>START PHASE</span><span>CURRENT STATUS</span>
                    </div>
                </div>
            `;
        }

        function hideSubView() {
            document.getElementById('sub-view').classList.add('hidden');
            document.getElementById('main-view').classList.remove('hidden');
        }

        function tick() {
            const now = new Date();
            els.clock.innerText = now.getHours().toString().padStart(2,'0') + ":" + now.getMinutes().toString().padStart(2,'0');
            const diff = new Date("2026-03-14T00:00:00").getTime() - now.getTime();
            if (diff > 0) els.countdown.innerText = Math.floor(diff/(1000*60*60*24)) + "天 " + Math.floor((diff%(1000*60*60*24))/(1000*60*60)) + "小時";
        }
        setInterval(tick, 60000); tick();
    </script>
    <script src="config.js"></script>
</body>
</html>